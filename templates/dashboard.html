<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="UISP Auto-Adopter Dashboard â€” Monitor and manage Ubiquiti device adoption">
    <title>ğŸ“¡ UISP Auto-Adopter Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“¡</text></svg>">
</head>

<body>

    <div class="app-container">

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <header class="header">
            <div class="header-left">
                <div class="header-logo">ğŸ“¡</div>
                <div>
                    <h1 class="header-title">UISP Auto-Adopter</h1>
                    <div class="header-subtitle">Ubiquiti Cihaz YÃ¶netim Paneli</div>
                </div>
            </div>
            <div class="header-right">
                <div id="config-status" class="status-badge not-configured">
                    <span class="status-dot red"></span> YÃ¼kleniyor...
                </div>
                <span class="version-tag">v{{ version }}</span>
            </div>
        </header>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAVIGATION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="overview">
                <span class="tab-icon">ğŸ“Š</span>
                <span>Genel BakÄ±ÅŸ</span>
            </button>
            <button class="nav-tab" data-tab="scan">
                <span class="tab-icon">ğŸ”</span>
                <span>Tarama</span>
            </button>
            <button class="nav-tab" data-tab="devices">
                <span class="tab-icon">ğŸ“¡</span>
                <span>Cihazlar</span>
            </button>
            <button class="nav-tab" data-tab="subnets">
                <span class="tab-icon">ğŸŒ</span>
                <span>Alt AÄŸlar</span>
            </button>
            <button class="nav-tab" data-tab="config">
                <span class="tab-icon">âš™ï¸</span>
                <span>YapÄ±landÄ±rma</span>
            </button>
            <button class="nav-tab" data-tab="logs">
                <span class="tab-icon">ğŸ“‹</span>
                <span>Loglar</span>
            </button>
        </nav>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: OVERVIEW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="tab-overview" class="tab-content active">

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card blue">
                    <div class="stat-icon">ğŸ“¡</div>
                    <div class="stat-value" id="stat-total-devices">0</div>
                    <div class="stat-label">Toplam BaÄŸlÄ± Cihaz</div>
                </div>
                <div class="stat-card purple">
                    <div class="stat-icon">ğŸŒ</div>
                    <div class="stat-value" id="stat-networks">0</div>
                    <div class="stat-label">AÄŸ BloÄŸu</div>
                </div>
                <div class="stat-card green">
                    <div class="stat-icon">âœ…</div>
                    <div class="stat-value" id="stat-last-adopted">0</div>
                    <div class="stat-label">Son Tarama â€” BaÅŸarÄ±lÄ±</div>
                </div>
                <div class="stat-card orange">
                    <div class="stat-icon">âŒ</div>
                    <div class="stat-value" id="stat-last-failed">0</div>
                    <div class="stat-label">Son Tarama â€” BaÅŸarÄ±sÄ±z</div>
                </div>
            </div>

            <!-- Last Scan Info -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸ“ˆ</span> Son Tarama Bilgileri
                    </div>
                    <button class="btn btn-sm" onclick="loadStats()">ğŸ”„ Yenile</button>
                </div>
                <div class="card-body">
                    <div class="config-grid" id="last-scan-info">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“Š</div>
                            <div class="empty-desc">HenÃ¼z tarama yapÄ±lmadÄ±</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">âš¡</span> HÄ±zlÄ± Ä°ÅŸlemler
                    </div>
                </div>
                <div class="card-body">
                    <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="switchTab('scan')">
                            ğŸš€ Tarama BaÅŸlat
                        </button>
                        <button class="btn btn-success" onclick="switchTab('devices')">
                            ğŸ“¡ Cihaz Listesi
                        </button>
                        <button class="btn" onclick="switchTab('subnets')">
                            ğŸŒ Alt AÄŸ DaÄŸÄ±lÄ±mÄ±
                        </button>
                        <button class="btn" onclick="switchTab('logs')">
                            ğŸ“‹ LoglarÄ± GÃ¶rÃ¼ntÃ¼le
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: SCAN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="tab-scan" class="tab-content">

            <!-- Scan Controls -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸš€</span> AÄŸ TaramasÄ±
                    </div>
                </div>
                <div class="card-body">
                    <div class="scan-controls">
                        <button id="btn-start-scan" class="btn btn-primary" onclick="startScan()">
                            ğŸš€ TaramayÄ± BaÅŸlat
                        </button>
                        <button id="btn-stop-scan" class="btn btn-danger" onclick="stopScan()" disabled>
                            ğŸ›‘ Durdur
                        </button>
                        <div class="scan-options">
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="dry-run-checkbox">
                                <label for="dry-run-checkbox">ğŸ§ª Deneme Modu (Dry-Run)</label>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <label for="threads-input"
                                style="font-size: 0.85rem; color: var(--text-secondary);">Thread:</label>
                            <input type="number" id="threads-input" value="10" min="1" max="50" class="ip-input"
                                style="width: 80px; padding: 8px 12px;">
                        </div>
                    </div>

                    <!-- Running Indicator -->
                    <div id="scan-running-indicator" class="scan-running-indicator hidden">
                        <div class="spinner"></div>
                        <span>Tarama devam ediyor...</span>
                    </div>

                    <!-- Progress -->
                    <div class="progress-container">
                        <div class="progress-bar-wrapper">
                            <div id="scan-progress-bar" class="progress-bar" style="width: 0%"></div>
                        </div>
                        <div class="progress-info">
                            <span id="scan-progress-percent" class="progress-percent">0%</span>
                            <span id="scan-progress-adopted"></span>
                            <span id="scan-progress-elapsed">0s</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Live Log -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸ“‹</span> CanlÄ± Log
                    </div>
                </div>
                <div class="card-body" style="padding: 0;">
                    <div id="live-log" class="log-container">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“‹</div>
                            <div class="empty-desc">Tarama baÅŸlatÄ±ldÄ±ÄŸÄ±nda loglar burada gÃ¶rÃ¼necek</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Single Device Adopt -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸ¯</span> Tek Cihaz BaÄŸla
                    </div>
                </div>
                <div class="card-body">
                    <div class="single-adopt-form">
                        <input type="text" id="single-ip-input" class="ip-input"
                            placeholder="IP adresi girin (Ã¶rn: 10.0.0.50)"
                            onkeypress="if(event.key==='Enter')adoptSingleDevice()">
                        <div class="checkbox-wrapper">
                            <input type="checkbox" id="single-dry-run">
                            <label for="single-dry-run">ğŸ§ª Deneme</label>
                        </div>
                        <button class="btn btn-success" onclick="adoptSingleDevice()">
                            âš¡ BaÄŸla
                        </button>
                    </div>
                    <div id="single-adopt-result" class="hidden" style="margin-top: 16px;"></div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: DEVICES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="tab-devices" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸ“¡</span> BaÄŸlÄ± Cihazlar
                    </div>
                    <div class="card-actions">
                        <span id="device-count" class="device-count">0 cihaz</span>
                        <button class="btn btn-sm" onclick="loadDevices()">ğŸ”„ Yenile</button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Filters -->
                    <div class="table-controls">
                        <div class="search-wrapper">
                            <span class="search-icon">ğŸ”</span>
                            <input type="text" id="device-search" class="search-input"
                                placeholder="IP adresi ile ara..." oninput="debouncedFilter()">
                        </div>
                        <select id="subnet-filter" class="filter-select" onchange="filterDevices()">
                            <option value="">TÃ¼m Alt AÄŸlar</option>
                        </select>
                    </div>

                    <!-- Device Table -->
                    <div class="table-wrapper">
                        <table class="device-table">
                            <thead>
                                <tr>
                                    <th style="width: 50px;">#</th>
                                    <th>IP Adresi</th>
                                    <th>Alt AÄŸ</th>
                                    <th>Durum</th>
                                </tr>
                            </thead>
                            <tbody id="device-table-body">
                                <tr>
                                    <td colspan="4" class="text-center"
                                        style="padding: 60px; color: var(--text-muted);">
                                        YÃ¼kleniyor...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: SUBNETS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="tab-subnets" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸŒ</span> Alt AÄŸ DaÄŸÄ±lÄ±mÄ±
                    </div>
                    <button class="btn btn-sm" onclick="loadSubnets()">ğŸ”„ Yenile</button>
                </div>
                <div class="card-body">
                    <div id="subnet-grid" class="subnet-grid">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸŒ</div>
                            <div class="empty-desc">YÃ¼kleniyor...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: CONFIG â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="tab-config" class="tab-content">

            <!-- UISP Connection String -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸ”—</span> UISP BaÄŸlantÄ± Dizesi
                    </div>
                </div>
                <div class="card-body">
                    <div class="single-adopt-form">
                        <input type="text" id="uisp-string-input" class="ip-input" style="font-size: 0.8rem;"
                            placeholder="wss://server:8443+Token+allowSelfSignedCertificate">
                        <button class="btn btn-primary" onclick="saveUispString()">
                            ğŸ’¾ Kaydet
                        </button>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.75rem; color: var(--text-muted);">
                        UISP Server â†’ Devices â†’ Add Device bÃ¶lÃ¼mÃ¼nden alabilirsiniz.
                    </p>
                </div>
            </div>

            <!-- Network Ranges -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸŒ</span> AÄŸ AralÄ±klarÄ±
                    </div>
                    <span id="network-count-badge" class="device-count">0 aÄŸ</span>
                </div>
                <div class="card-body">
                    <!-- Add Network Form -->
                    <div class="single-adopt-form" style="margin-bottom: 16px;">
                        <input type="text" id="new-network-input" class="ip-input"
                            placeholder="Yeni aÄŸ aralÄ±ÄŸÄ± (Ã¶rn: 10.0.0.0/24)"
                            onkeypress="if(event.key==='Enter')addNetwork()">
                        <button class="btn btn-success" onclick="addNetwork()">
                            â• Ekle
                        </button>
                    </div>
                    <!-- Network List -->
                    <div id="network-list-container"></div>
                </div>
            </div>

            <!-- Credentials -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸ”‘</span> SSH Kimlik Bilgileri
                    </div>
                    <span id="cred-count-badge" class="device-count">0 kimlik</span>
                </div>
                <div class="card-body">
                    <!-- Add Credential Form -->
                    <div class="single-adopt-form" style="margin-bottom: 16px;">
                        <input type="text" id="new-cred-username" class="ip-input" style="max-width: 200px;"
                            placeholder="KullanÄ±cÄ± adÄ±">
                        <input type="password" id="new-cred-password" class="ip-input" style="max-width: 200px;"
                            placeholder="Åifre" onkeypress="if(event.key==='Enter')addCredential()">
                        <button class="btn btn-success" onclick="addCredential()">
                            â• Ekle
                        </button>
                    </div>
                    <!-- Credential List -->
                    <div id="credential-list-container"></div>
                </div>
            </div>

            <!-- Scanning Settings -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">âš™ï¸</span> Tarama AyarlarÄ±
                    </div>
                </div>
                <div class="card-body">
                    <div class="config-grid">
                        <div class="config-item" style="flex-direction: column; align-items: stretch; gap: 8px;">
                            <label class="config-label">EÅŸzamanlÄ± Thread SayÄ±sÄ±</label>
                            <input type="number" id="setting-max-threads" class="ip-input" min="1" max="100"
                                style="padding: 8px 12px;">
                        </div>
                        <div class="config-item" style="flex-direction: column; align-items: stretch; gap: 8px;">
                            <label class="config-label">SSH Timeout (saniye)</label>
                            <input type="number" id="setting-ssh-timeout" class="ip-input" min="1" max="60" step="0.5"
                                style="padding: 8px 12px;">
                        </div>
                        <div class="config-item" style="flex-direction: column; align-items: stretch; gap: 8px;">
                            <label class="config-label">Port Tarama Timeout (saniye)</label>
                            <input type="number" id="setting-port-timeout" class="ip-input" min="0.1" max="10"
                                step="0.1" style="padding: 8px 12px;">
                        </div>
                        <div class="config-item" style="flex-direction: column; align-items: stretch; gap: 8px;">
                            <label class="config-label">Dashboard Port</label>
                            <input type="number" id="setting-dashboard-port" class="ip-input" min="1024" max="65535"
                                style="padding: 8px 12px;">
                        </div>
                    </div>
                    <div style="margin-top: 16px; display: flex; gap: 12px;">
                        <button class="btn btn-primary" onclick="saveSettings()">
                            ğŸ’¾ AyarlarÄ± Kaydet
                        </button>
                        <span style="font-size: 0.75rem; color: var(--text-muted); display: flex; align-items: center;">
                            âš¡ Ayarlar anÄ±nda uygulanÄ±r â€” yeniden baÅŸlatma gerekmez!
                        </span>
                    </div>
                </div>
            </div>

            <!-- Config File Info -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">â„¹ï¸</span> YapÄ±landÄ±rma Bilgisi
                    </div>
                </div>
                <div class="card-body">
                    <div style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8;">
                        <p>TÃ¼m ayarlar <code
                                style="background: var(--bg-glass); padding: 2px 8px; border-radius: 4px; font-family: var(--font-mono);">config.json</code>
                            dosyasÄ±nda saklanÄ±r.</p>
                        <p>DeÄŸiÅŸiklikler anÄ±nda uygulanÄ±r â€” sunucuyu yeniden baÅŸlatmanÄ±za gerek yoktur.</p>
                        <p style="color: var(--text-muted); margin-top: 8px;">
                            ğŸ“ Her kaydetme iÅŸleminde otomatik yedek oluÅŸturulur (<code>config.json.backup</code>)
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: LOGS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="tab-logs" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon">ğŸ“‹</span> Log DosyasÄ±
                    </div>
                    <div class="card-actions">
                        <button class="btn btn-sm" onclick="loadLogs()">ğŸ”„ Yenile</button>
                    </div>
                </div>
                <div class="card-body" style="padding: 0;">
                    <div id="file-log" class="log-container" style="max-height: 600px;">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“‹</div>
                            <div class="empty-desc">YÃ¼kleniyor...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- JavaScript -->
    <script src="/static/js/dashboard.js"></script>

</body>

</html>